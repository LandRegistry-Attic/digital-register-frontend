{% extends "layout.html" %}

{% block body %}

{% if is_caution_title %}
    <span class="alert-flag-hi-viz">Caution against first registration</span>
    <br>
  {% endif %}

<h1 class="heading-xlarge collapse-bottom">Summary of title {{params.title.number}}</h1>

<p class="expand-bottom">This title was last changed on <b>{{params.last_changed_datestring}} at {{params.last_changed_timestring}}</p>

<div class="grid-row">
  <div class="column-two-thirds">
    <div class="text">
      <div itemscope itemtype="http://schema.org/PostalAddress" class="lede">
        {% for line in params.title.address_lines %}
          <span>{{line}}</span><br/>
        {% endfor %}
      </div>
      <br/>

      <dl class="definition-tabular">
        <dt>Tenure type</dt>
        <dd><b>{{params.title.tenure}}</b></dd>
      </dl>
    </div>

    <div class="service-notice font-xsmall">
      <p>The <b>title register</b> contains details about the property or land, including:</p>
      <ul class="list-bullet">
        <li>title number</li>
        <li>who owns it</li>
        <li>what they paid for it (properties only, if available)</li>
        <li>any rights of way</li>
      </ul>
    </div>
    <br/>
    <dl class="definition-tabular font-xsmall">
      <dt>Amount to pay</dt>
      {% autoescape false %}
      <dd><b>{{params.price}}</b></dd>
      {% endautoescape %}
    </dl>

    <br/>

    # Send data to "Payment Service Interface", perhaps via a 'spinner' page.
    <form class="form" action="{{params.post_confirmation_url}}" method="post">
      <input type='hidden' name='title_number' id='title_number' value="{{params.title_number}}"/>
      <input type='hidden' name='price' id='price' value="{{params.price}}"/>
      <input type='hidden' name='address_lines' id='address_lines' value="{{params.title.address_lines}}"/>

      <!-- Mandatory parameters passed in from "payment request" form -->
      <input type="hidden" id="cartId" name="cartId" value="{{worldpay_params.cartid}}">
      <input type="hidden" id="amount" name="amount"	value="{{worldpay_params.amount}}">

      <!-- Custom parameters passed in from "payment request" form -->
      <input type="hidden" id="MC_titleNumber" name="MC_titleNumber"	value="{{worldpay_params.mc_titlenumber}}">
      <input type="hidden" id="MC_timestamp" name="MC_timestamp" value="{{worldpay_params.mc_timestamp}}">
      <input type="hidden" id="MC_purchaseType" name="MC_purchaseType" value="{{worldpay_params.mc_purchasetype}}">
      <input type="hidden" id="MC_searchType" name="MC_searchType" value="{{worldpay_params.mc_searchtype}}">


      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
      <button type="submit" class="button" >Buy Now</button>
    </form>

  </div>

</div>

{% endblock %}
